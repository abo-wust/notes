已剪辑自: [https://blog.csdn.net/u010183728/article/details/81984433](https://blog.csdn.net/u010183728/article/details/81984433)

一、简介

1\. SPI

SPI（Serial Peripheral Interface，串行外设接口）是Motorola公司提出的一种同步串行数据传输标准，在很多器件中被广泛应用。

1. 接口
SPI接口经常被称为4线串行总线，以主/从方式工作，数据传输过程由主机初始化。如图1所示，其使用的4条信号线分别为：
1) SCLK：串行时钟，用来同步数据传输，由主机输出；
2) MOSI：主机输出从机输入数据线，通常先传输MSB；
3) MISO：主机输入从机输出数据线，通常先传输LSB；
4) SS：片选线，低电平有效，由主机输出。
在SPI总线上，某一时刻可以出现多个从机，但只能存在一个主机，主机通过片选线来确定要通信的从机。这就要求从机的MISO口具有三态特性，使得该口线在器件未被选通时表现为高阻抗。

![](images/Pasted%20image%2020221202001334.png)

2. 数据传输
在一个SPI时钟周期内，会完成如下操作：
1) 主机通过MOSI线发送1位数据，从机通过该线读取这1位数据；
2) 从机通过MISO线发送1位数据，主机通过该线读取这1位数据。
这是通过移位寄存器来实现的。如图2所示，主机和从机各有一个移位寄存器，且二者连接成环。随着时钟脉冲，数据按照从高位到低位的方式依次移出主机寄存器和从机寄存器，并且依次移入从机寄存器和主机寄存器。当寄存器中的内容全部移出时，相当于完成了两个寄存器内容的交换。

![](images/Pasted%20image%2020221202001338.png)

3. 时钟极性和时钟相位
在SPI操作中，最重要的两项设置就是时钟极性（CPOL或UCCKPL）和时钟相位（CPHA或UCCKPH）。时钟极性设置时钟空闲时的电平，时钟相位设置读取数据和发送数据的时钟沿。
主机和从机的发送数据是同时完成的，两者的接收数据也是同时完成的。所以为了保证主从机正确通信，应使得它们的SPI具有相同的时钟极性和时钟相位。
举例来说，分别选取MSP430控制器和OLED驱动SH1101A为主从机，图3和图4为它们的SPI时序。由图4可知，SH1101A的SPI时钟空闲时为高电平，并且在后时钟沿接收数据，则MSP430控制器SPI的设置应与此保持一致。从图3中可以看出，要使得时钟在空闲时为高电平，应将UCCKPL置1；要使得在后时钟沿接收数据，应将UCCKPH清零。

![](images/Pasted%20image%2020221202001343.png)



![](images/Pasted%20image%2020221202001347.png)

4. 优缺点
SPI接口具有如下优点：
1) 支持全双工操作；
2) 操作简单；
3) 数据传输速率较高。
同时，它也具有如下缺点：
1) 需要占用主机较多的口线（每个从机都需要一根片选线）；
2) 只支持单个主机。

**2\. I2C**

1. 接口

![](images/Pasted%20image%2020221202001352.png)

I2C接口包括时钟线（SCL）和数据线（SDA）。这两条线都是漏极开路或者集电极开路结构，使用时需要外加上拉电阻，可以挂载多个设备。每个设备都有自己的地址，主机通过不同地址来选中不同的设备。

2. 一般操作
1）主机给从机发数据



- 发送开始条件START和从机地址；
- 发送数据；
- 发送停止条件STOP结束。
2）主机从从机读取数据
- 发送开始条件START和从机地址；
- 发送要读取的地址；
- 读取数据；
- 发送停止条件STOP结束。
2.1开始和结束条件
当SCL保持高电平期间，SDA从高电平跳变到低电平，即为开始条件START。当SCL保持高电平期间，SDA从低电平跳变到高电平，即为结束条件STOP。

![](images/Pasted%20image%2020221202001358.png)

2.2 重复的起始条件
与起始条件的区别是，它出现在结束条件STOP之前。例如读取数据时，发送START、从机地址、要读取的地址后，不需要发送STOP，而可以发送重复起始条件和从机地址，开始数据读取。
2.3 ACK和NACK
数据传输时先传MSB。接收者在每个字节后的第9个时钟周期将SDA保持低电平进行确认数据接收成功；而在第9个时钟周期将SDA保持高电平表示数据传输出错，或者主机不再想接收数据。

![](images/Pasted%20image%2020221202001402.png)

![](images/Pasted%20image%2020221202001405.png)

1. 数据读写
1）写数据

![](images/Pasted%20image%2020221202001410.png)

2）读数据

![](images/Pasted%20image%2020221202001413.png)

2. 优缺点
1）优点
只使用两条信号线；
支持多主机多从机；
有应答机制。
2）缺点
速率比SPI慢。



UART是一种异步传输接口，不需要时钟线，通过起始位和停止位及波特率进行数据识别。

1. 接口
UART仅使用两条线TXD和RXD用于数据的发和收。

![](images/Pasted%20image%2020221202001417.png)

2. 数据格式
1）起始位
数据线空闲状态为高电平，要发送数据时将其拉低一个时钟周期表示起始位。
2）数据位
使用校验位时，数据位可以有5~8位；如果不使用校验位，数据位可以达9位。
3）校验位
奇偶校验，保证包括校验位和数据位在内的所有位中1的个数为奇数或偶数。
4）停止位
为了表示数据包的结束，发送端需要将信号线从低电平变为高电平，并至少保持2个时钟周期。
3. 优缺点
1）优点
只使用两条信号线；
不需要时钟信号；
有校验位进行错误检测；
2）缺点
传输速率比较低。

4\. CAN

![](images/Pasted%20image%2020221202001421.png)

CAN，全称为“Controller Area Network”，即控制器局域网，是国际上应用最广泛的现场总线之一。最初，CAN被设计作为汽车环境中的微控制器通讯，在车载各电子控制装置ECU之间交换信息，形成汽车电子控制网络。比如：发动机管理系统、变速箱控制器、仪表装备、电子主干系统中，均嵌入CAN控制装置。

一个由CAN总线构成的单一网络中，理论上可以挂接无数个节点。实际应用中，节点数目受网络硬件的电气特性所限制。例如，当使用Philips P82C250作为CAN收发器时，同一网络中允许挂接110个节点。CAN 可提供高达1Mbit/s的数据传输速率，这使实时控制变得非常容易。另外，硬件的错误检定特性也增强了CAN的抗电磁干扰能力。

**CAN总线的特点：**

1)可以多主方式工作，网络上任意一个节点均可以在任意时刻主动地向网络上的其他节点发送信息，而不分主从，通信方式灵活。

2)网络上的节点可分成不同的优先级，可以满足不同的实时要求。

3)采用非破坏性位仲裁总线结构机制，当两个节点同时向网络上传送信息时，优先级低的节点主动停止数据发送，而优先级高的节点可不受影响地继续传送数据。

4)可以点对点，一点对多点及全局广播几种传送方式接收数据。

5)直接通信距离最远可达10km(速率4Kbps以下)。

6)通信速率最高可达1MB/s(此时距离最长40m)。

二、对比

SPI 和I2C这两种通信方式都是短距离的，芯片和芯片之间或者其他元器件如传感器和芯片之间的通信。SPI和IIC是板上通信,IIC有时也会做板间通信,不过距离甚短,不过超过一米,例如一些触摸屏,手机液晶屏那些薄膜排线很多用IIC,I2C能用于替代标准的并行总线，能连接的各种集成电路和功能模块。I2C是多主控总线，所以任何一个设备都能像主控器一样工作，并控制总线。总线上每一个设备都有一个独一无二的地址，根据设备它们自己的能力，它们可以作为发射器或接收器工作。多路微控制器能在同一个I2C总线上共存这两种线属于低速传输。

而UART是应用于两个设备之间的通信，如用单片机做好的设备和计算机的通信。这样的通信可以做长距离的。UART速度比上面两者者快,最高达100K左右,用与计算机与设备或者计算机和计算之间通信,但有效范围不会很长,约10米左右,UART优点是支持面广,程序设计结构很简单,随着USB的发展,UART也逐渐走向下坡。

CAN 通讯距离最大是10 公里（设速率为5Kbps）,或最大通信速率为1Mbps(设通信距离为40 米)。
CAN 总线上的节点数可达110 个。通信介质可在双绞线，同轴电缆，光纤中选择。
CAN 采用非破坏性的总线仲裁技术，当多个节点同时发送数据时，优先级低的节点会主动退出发送，高优先级的节点可继续发送，节省总线仲裁时间。
CAN 是多主方式工作，网上的任一节点均可在任意时刻主动地向网络上其他节点发送信息。
CAN 采用报文识别符识别网络上的节点，从而把节点分成不同的优先级，高优先级的节点享有传送报文的优先权。报文是短帧结构，短的传送时间使其受干扰概率低，CAN 有很好的效验机制，这些都保证了CAN 通信的可靠性。

参考：

[http://blog.51cto.com/13695010/2096153](http://blog.51cto.com/13695010/2096153)

[https://blog.csdn.net/weibo1230123/article/details/79021485](https://blog.csdn.net/weibo1230123/article/details/79021485)

